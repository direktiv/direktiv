version: '3'

vars: 
  VERSION: '{{.VERSION | default "dev"}}'

tasks:  
  check:
    desc: Checks if version has the right syntax for Direktiv builds
    cmds:
    - |
      {{- if not (regexMatch "(^v[0-9]\\.[0-9]*\\.[0-9]$)|^latest$|^dev$" .VERSION) -}}
        echo "wrong version format: {{ .VERSION }}. Either v0.0.0, dev or latest."
        exit 1
      {{- end -}}
    internal: true